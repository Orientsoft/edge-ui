(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{631:function(e,t,n){e.exports={"next-sr-only":"TableSelect--next-sr-only--j3FWhkm",popup:"TableSelect--popup--1D-n31t",pagination:"TableSelect--pagination--1krlyTJ"}},632:function(e,t,n){e.exports={"next-sr-only":"Tasks--next-sr-only--224TnKn",page:"Tasks--page--Zcy2kls",toolbar:"Tasks--toolbar--1RMeGI8",actions:"Tasks--actions--2DO2mfa",online:"Tasks--online--1Mzao9r",offline:"Tasks--offline--1LOc2pO"}},637:function(e,t,n){"use strict";n.r(t);var a=n(610),r=n(609),o=n(275),l=n(96),i=n(273),c=n(143),u=n(612),s=n(611),d=n(142),m=n(56),f=n(613),p=n(615),v=n(614),y=n(192),b=n(1),g=n.n(b),E=n(617),h=n(618),O=n(631),S=n.n(O);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function j(e,t){return I(e)||k(e,t)||C()}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function k(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],a=!0,r=!1,o=void 0;try{for(var l=e[Symbol.iterator](),i;!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}}function I(e){if(Array.isArray(e))return e}function x(e,t){if(null==e)return{};var n=A(e,t),a,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function A(e,t){if(null==e)return{};var n={},a=Object.keys(e),r,o;for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}var T=function e(t){var n=t.dataSource,a=t.pageSize,r=void 0===a?10:a,o=x(t,["dataSource","pageSize"]),l,i=j(Object(b.useState)([]),2),c=i[0],u=i[1],d,m=j(Object(b.useState)(1),2),f=m[0],p=m[1],v=Array.isArray(n)?n.length:0;return Object(b.useEffect)(function(){var e=(f-1)*r,t=e+r;Array.isArray(n)?u(n.slice(e,t)):u([])},[f,n,r]),g.a.createElement("div",{className:S.a.popup},g.a.createElement(s.a,w({size:"small",dataSource:c,useVirtual:!0},o)),g.a.createElement(h.a,{className:S.a.pagination,shape:"arrow-only",current:f,total:v,pageSize:r,onChange:function e(t){return p(t)},hideOnlyOnePage:!0,showJump:!1}))},q=function e(t){var n=t.name,a=t.value,o=x(t,["name","value"]);return g.a.createElement(r.a,{name:n,mode:"multiple",value:a,popupContent:g.a.createElement(T,o)})};q.Column=s.a.Column;var N=q,_=n(274),M=n(115),z=n(632),J=n.n(z);function P(e){return K(e)||D(e)||F()}function F(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function D(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function K(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function R(e,t){return G(e)||V(e,t)||U()}function U(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function V(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],a=!0,r=!1,o=void 0;try{for(var l=e[Symbol.iterator](),i;!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}}function G(e){if(Array.isArray(e))return e}var L=t.default=function(){var e,t=R(Object(b.useState)([]),2),n=t[0],a=t[1],o,i=R(Object(b.useState)([]),2),u=i[0],d=i[1],f,v=R(Object(b.useState)([]),2),E=v[0],h=v[1],O,S=R(Object(b.useState)([]),2),w=S[0],j=S[1],C,k=R(Object(b.useState)(!1),2),I=k[0],x=k[1],A,T=R(Object(b.useState)([]),2),q=T[0],z=T[1],F,D=R(Object(b.useState)(_.a.None),2),K=D[0],U=D[1],V=y.a.useField(),G=function e(t){console.log(t)},L=function e(){x(!0),M.e.query().then(function(e){var t=e.data;x(!1),a(t)})},W=function e(){V.validate(function(e,t){e||M.e.create({data:{name:t.name,service_id:t.service_id,node_ids:t.node_ids.map(function(e){var t;return e.value})}}).then(function(){U(_.a.None),L()})})},Z=function e(){V.validate(function(e,t){e||M.e.update({data:{id:t.id,name:t.name,node_ids:t.node_ids.map(function(e){var t;return e.value})}}).then(function(){U(_.a.None),L()})})},B=function e(t){h([]),M.c.queryNodes({},{serviceId:t}).then(function(e){var t=e.data;return h(t)})},H=function e(t){p.a.confirm({title:"".concat(t.running?"\u505c\u6b62":"\u542f\u52a8","\u4efb\u52a1"),content:"\u786e\u5b9a".concat(t.running?"\u505c\u6b62":"\u542f\u52a8","\u5f53\u524d\u4efb\u52a1\uff1f"),closeable:!1,onOk:function e(){return M.e.toggleTask({data:{operator:t.running?"stop":"start"}},{taskId:t.id}).then(L)}})},Q=Object(b.useMemo)(function(){return{selectedRowKeys:w.map(function(e){var t;return e.id}),onSelect:function e(t,n){j(t?[].concat(P(w),[n]):w.filter(function(e){var t;return e.id!==n.id}))},onSelectAll:function e(t,n){j(t?P(n):[])}}},[w]),X=function e(){V.reset(),h([]),j([]),U(_.a.Create),M.c.query().then(function(e){var t=e.data;return d(t)})},Y=function e(t){V.setValues(t),h([]),j(t.nodes),U(_.a.Update),M.c.queryNodes({},{serviceId:t.service_id}).then(function(e){var t=e.data;h(t)})},$=function e(t){return p.a.confirm({title:"\u5220\u9664\u4efb\u52a1",content:"\u786e\u5b9a\u5220\u9664\u5f53\u524d\u4efb\u52a1\uff1f",closeable:!1,onOk:function e(){return M.e.delete({data:{id:t.id}}).then(L)}})},ee=function e(t){return t?g.a.createElement("span",{className:J.a.online},"\u8fd0\u884c\u4e2d"):g.a.createElement("span",{className:J.a.offline},"\u672a\u8fd0\u884c")},te=function e(t){var n=t.length,a=t.filter(function(e){var t;return e.online}).length;return"".concat(a,"/").concat(n)},ne=function e(t,n,a){return g.a.createElement("div",{className:J.a.actions},g.a.createElement(m.a,{type:"primary",onClick:function e(){return H(a)}},a.running?"\u505c\u6b62":"\u542f\u52a8"),g.a.createElement(m.a,{type:"secondary",disabled:a.running,onClick:function e(){return Y(a)}},"\u7f16\u8f91"),g.a.createElement(m.a,{type:"normal",disabled:a.running,warning:!0,onClick:function e(){return $(a)}},"\u5220\u9664"))};return Object(b.useEffect)(function(){return L()},[]),g.a.createElement("div",{className:J.a.page},g.a.createElement("div",{className:J.a.toolbar},g.a.createElement(m.a,{type:"primary",onClick:X},"\u65b0\u5efa\u4efb\u52a1")),g.a.createElement(s.a,{dataSource:n,loading:I},g.a.createElement(s.a.Column,{dataIndex:"name",title:"\u540d\u79f0"}),g.a.createElement(s.a.Column,{dataIndex:"service_name",title:"\u670d\u52a1"}),g.a.createElement(s.a.Column,{dataIndex:"nodes",title:"\u5728\u7ebf\u6570/\u603b\u8282\u70b9\u6570",cell:te}),g.a.createElement(s.a.Column,{dataIndex:"running",title:"\u72b6\u6001",cell:ee}),g.a.createElement(s.a.Column,{title:"\u64cd\u4f5c",width:220,cell:ne})),g.a.createElement(p.a,{visible:K===_.a.Create,title:"\u65b0\u5efa\u4efb\u52a1",closeable:!1,onOk:W,onCancel:function e(){return U(_.a.None)}},g.a.createElement(l.a,{field:V,labelCol:{span:4},wrapperCol:{span:20},style:{width:480}},g.a.createElement(l.a.Item,{label:"\u540d\u79f0\uff1a",required:!0,requiredMessage:"\u5fc5\u586b\u9879\u4e0d\u80fd\u4e3a\u7a7a"},g.a.createElement(c.a,{name:"name"})),g.a.createElement(l.a.Item,{label:"\u670d\u52a1\uff1a",required:!0,requiredMessage:"\u5fc5\u586b\u9879\u4e0d\u80fd\u4e3a\u7a7a"},g.a.createElement(r.a,{name:"service_id",onChange:B},u.map(function(e){var t=e.id,n=e.name;return g.a.createElement(r.a.Option,{key:t,value:t},n)}))),g.a.createElement(l.a.Item,{label:"\u8282\u70b9\uff1a",required:!0,requiredMessage:"\u5fc5\u586b\u9879\u4e0d\u80fd\u4e3a\u7a7a"},g.a.createElement(N,{name:"node_ids",value:w.map(function(e){var t=e.id,n;return{label:e.name,value:t}}),rowSelection:Q,dataSource:E},g.a.createElement(N.Column,{title:"\u540d\u79f0",dataIndex:"name"}),g.a.createElement(N.Column,{title:"\u7c7b\u578b",dataIndex:"arch"}))))),g.a.createElement(p.a,{visible:K===_.a.Update,title:"\u7f16\u8f91\u8282\u70b9",closeable:!1,onOk:Z,onCancel:function e(){return U(_.a.None)}},g.a.createElement(l.a,{field:V,labelCol:{span:4},wrapperCol:{span:20},style:{width:480}},g.a.createElement(l.a.Item,{label:"\u540d\u79f0\uff1a",required:!0,requiredMessage:"\u5fc5\u586b\u9879\u4e0d\u80fd\u4e3a\u7a7a"},g.a.createElement(c.a,{name:"name"})),g.a.createElement(l.a.Item,{label:"\u8282\u70b9\uff1a",required:!0,requiredMessage:"\u5fc5\u586b\u9879\u4e0d\u80fd\u4e3a\u7a7a"},g.a.createElement(N,{name:"node_ids",value:w.map(function(e){var t=e.id,n;return{label:e.name,value:t}}),rowSelection:Q,dataSource:E,onFilter:G},g.a.createElement(N.Column,{title:"\u540d\u79f0",dataIndex:"name"}),g.a.createElement(N.Column,{title:"\u7c7b\u578b",dataIndex:"arch",filters:q,filterMode:"single"}))))))}}}]);